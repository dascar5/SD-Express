jQuery(document).ready(function(a){var b,c;saajaxurl=SA_Ajax.ajaxurl,SA_last_activity=SA_Ajax.last_activity,running=!1,b=!0,c='',data.interval&&(SA_Ajax.focus=='yes'&&a(window).on('focusin',function(){b=!0}).on('focusout',function(){b=!1}),c=setInterval(function(){b==!0&&getPriceAuction()},data.interval*1e3)),a(".auction-time-countdown").each(function(e){var b=a(this).data('time'),c=a(this).data('format'),d;c==''&&(c='yowdHMS'),data.compact_counter=='yes'?compact=!0:compact=!1,d='',a(this).hasClass('future')?(d='<div class="started">'+data.started+'</div>'):(d='<div class="over">'+data.checking+'</div>'),a(' body').hasClass('logged-in')||(b=a.SAcountdown.UTCDate(-(new Date).getTimezoneOffset(),new Date(b*1e3))),a(this).SAcountdown({until:b,format:c,compact,onExpiry:closeAuction,expiryText:d})}),a('form.cart').submit(function(){clearInterval(c)}),a("input[name=bid_value]").on('changein',function(b){a(this).addClass('changein')}),a(".sealed-text a").on('click',function(b){b.preventDefault(),a('.sealed-bid-desc').slideToggle('fast')}),a(".sa-watchlist-action").on('click',d);function d(e){var b=jQuery(this).data('auction-id'),c=a(this);jQuery.ajax({type:"get",url:SA_Ajax.ajaxurl,data:{post_id:b,'wsa-ajax':"watchlist"},success:function(e){c.parent().replaceWith(e),a(".sa-watchlist-action").on('click',d),jQuery(document.body).trigger('sa-wachlist-action',[e,b])}})}});function closeAuction(){var b=jQuery(this).data('auctionid'),c=jQuery(this).hasClass('future')?'true':'false',a=jQuery(this).parent().next('.auction-ajax-change'),d;a.hide(),jQuery('<div class="ajax-working"></div>').insertBefore(a),a.parent().children('form.buy-now').hide(),d=saajaxurl+'=finish_auction',jQuery(document.body).trigger('sa-close-auction',[b]),request=jQuery.ajax({type:"post",url:d,cache:!1,data:{action:"finish_auction",post_id:b,ret:a.length,future:c},success:function(c){c?c.status=='closed'?(a.parent().children('form.buy-now').remove(),c.message&&(jQuery('.ajax-working').remove(),jQuery('.main-auction.auction-time-countdown[data-auctionid='+b+']').parent().remove(),a.empty().prepend(c.message).wrap("<div></div>"),a.show(),jQuery(document.body).trigger('sa-action-closed',[b]))):c.status=='running'?(getPriceAuction(),jQuery('.ajax-working').remove(),a.show(),a.parent().children('form.buy-now').show()):location.reload():location.reload()},error:function(){location.reload()}})}function getPriceAuction(){if(jQuery('.auction-price').length<1)return;if(running==!0)return;running=!0;var a=saajaxurl+'=get_price_for_auctions';jQuery.ajax({type:"post",encoding:"UTF-8",url:a,dataType:'json',data:{action:"get_price_for_auctions",last_activity:SA_last_activity},success:function(a){a!=null&&(typeof a.last_activity!='undefined'&&(SA_last_activity=a.last_activity),jQuery.each(a,function(b,a){var c,d,e;auction=jQuery("body").find(".auction-price[data-auction-id='"+b+"']"),auction.replaceWith(a.curent_bid),jQuery("body").find("[data-auction-id='"+b+"']").addClass('changed blink').fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100,function(){jQuery(this).removeClass('blink')}),typeof a.timer!='undefined'&&(c=jQuery("body").find(".auction-time-countdown[data-auctionid='"+b+"']"),c.attr('data-time')!=a.timer&&(c.attr('data-time',a.timer),jQuery(' body').hasClass('logged-in')?time=a.timer:time=jQuery.SAcountdown.UTCDate(-(new Date).getTimezoneOffset(),new Date(a.timer*1e3)),c.SAcountdown('option','until',time),c.addClass('changed blink').fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100,function(){jQuery(this).removeClass('blink')}))),typeof a.curent_bider!='undefined'&&(d=jQuery("input[name=user_id]"),e=jQuery("input[name=place-bid]").val(),d.length&&a.curent_bider!=d.val()&&e==b&&(jQuery('.woocommerce-message:contains("'+data.no_need+'")').replaceWith(data.outbid_message),jQuery(".reserve_not_meet[data-auction-id='"+b+"']").parent().replaceWith(data.outbid_message)),jQuery("span.winning[data-auction_id='"+b+"']").attr('data-user_id')!=a.curent_bider&&jQuery("span.winning[data-auction_id='"+b+"']").remove()),typeof a.bid_value!='undefined'&&(jQuery("input[name=bid_value][data-auction-id='"+b+"']").hasClass('changedin')||jQuery("input[name=bid_value][data-auction-id='"+b+"']").val(a.bid_value).removeClass('changedin')),typeof a.reserve!='undefined'&&jQuery(".auction-ajax-change .reserve[data-auction-id='"+b+"']").text(a.reserve),typeof a.activity!='undefined'&&(jQuery("#auction-history-table-"+b+" tbody > tr:first").before(a.activity),jQuery("#auction-history-table-"+b+" tbody > tr:first").addClass('changed blink').fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100).fadeOut(100).fadeIn(100,function(){jQuery(this).removeClass('blink')})),typeof a.add_to_cart_text!='undefined'&&jQuery("a.button.product_type_auction[data-product_id='"+b+"']").text(a.add_to_cart_text),jQuery(document.body).trigger('sa-action-price-changed',[b,a])})),jQuery(document.body).trigger('sa-action-price-respons',a),running=!1},error:function(){running=!1}})}jQuery(function(a){a(".auction_form div.quantity:not(.buttons_added),.auction_form td.quantity:not(.buttons_added)").addClass("buttons_added").append('<input type="button" value="+" class="plus" />').prepend('<input type="button" value="-" class="minus" />'),a(document).on("click",".auction_form .plus,.auction_form .minus",function(){var c=a(this).closest(".quantity").find("input[name=bid_value]"),b=parseFloat(c.val()),d=parseFloat(c.attr("max")),e=parseFloat(c.attr("min")),f=c.attr("step");b&&""!==b&&"NaN"!==b||(b=0),(""===d||"NaN"===d)&&(d=""),(""===e||"NaN"===e)&&(e=0),("any"===f||""===f||void 0===f||"NaN"===parseFloat(f))&&(f=1),a(this).is(".plus")?c.val(d&&(d==b||b>d)?d:b+parseFloat(f)):e&&(e==b||e>b)?c.val(e):b>0&&c.val(b-parseFloat(f)),c.trigger("change")})})